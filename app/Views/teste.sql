SELECT
  serv.cadastro,
  TRIM(serv.nome) nome,
  UPPER(serv.tiposervidor) tiposervidor,
  serv.regime,
  serv.tipofuncao,
  serv.nte,
  serv.municipio,
  serv.codsecul,
  serv.orgao,
  serv.ntec,
  serv.municipioc,
  serv.codseculc,
  serv.orgaoc,
  odp.sigla ntep,
  odp.municipio municipiop,
  odp.codsecul codseculp,
  odp.orgao orgaop,
  PROG.CLIENTELA,
  PROG.TIPOENSINO,
  PROG.TURNO,
  PROG.CODDISCIPLINA,
  prog.disciplina,
  prog.QTD
FROM
  (
    SELECT
      sv.cadastro,
      sv.nome,
      sv.codregime * 20 regime,
      ts.tiposervidor,
      tf.tipofuncao,
      od.sigla nte,
      od.direc,
      od.municipio,
      od.codorgao,
      od.codsecul,
      od.orgao,
      odc.sigla ntec,
      odc.direc direcc,
      odc.municipio municipioc,
      odc.codorgao codorgaoc,
      odc.codsecul codseculc,
      odc.orgao orgaoc
    FROM
      diario.servidores sv,
      diario.view_servidor_planocargos spc,
      diario.tiposservidor ts,
      diario.m_view_orgao_direc od,
      diario.m_view_orgao_direc odc,
      diario.funcoes fn,
      diario.tipofuncoes tf
    WHERE
      sv.cadastro = spc.cadastro
      AND sv.codfuncao = fn.codfuncao(+)
      AND fn.codtipofuncao = tf.codtipofuncao(+)
      AND sv.codtiposervidor = ts.codtiposervidor
      AND sv.codorgao = od.codorgao
      AND sv.codorgaocomp = odc.codorgao(+)
      AND od.anoreferencia = :anoref
      AND odc.anoreferencia(+) = :anoref --AND od.codsituacaoorgao = 1
      --and tf.codtipofuncao=3
      AND sv.codsituacao IN (
        0,
        1,
        2,
        3,
        4,
        5,
        6,
        7,
        8,
        9,
        10,
        11,
        12,
        13,
        14,
        15,
        16,
        17,
        18,
        19,
        20,
        22,
        23,
        24,
        25,
        26,
        27,
        28,
        29,
        30,
        31,
        32,
        33,
        36,
        37,
        38,
        39,
        40,
        41,
        42,
        43,
        44,
        45,
        46,
        47,
        48,
        49,
        58,
        60,
        61,
        62,
        63,
        64,
        65,
        66,
        67,
        68,
        69,
        70,
        71,
        88
      )
      AND spc.codcargo IN (100, 102, 120, 50100, 50120, 54093)
      AND sv.provisorio = 'N'
      AND sv.excluidasirh = 0
  ) serv,
  (
    SELECT
      PROG.CODORGAO,
      PROG.CADASTRO,
      PROG.CLIENTELA,
      PROG.TIPOENSINO,
      PROG.TURNO,
      PROG.CODDISCIPLINA,
      prog.disciplina,
      SUM (PROG.QTD) QTD
    FROM
      (
        /*As Normal*/
        SELECT
          au.coddisciplina,
          D.DISCIPLINA,
          C.CODCLIENTELA,
          C.CLIENTELA,
          TE.TIPOENSINO,
          ase.tipoaula,
          AU.CODORGAO,
          ase.cadastro,
          'VAGA REAL' TIPOPROG,
          tu.turno,
          tm.turma,
          --'EXTRA' TIPOAULA,
          ase.datainicioprogramacao AS datainicio,
          ase.dataterminoprogramacao AS datafim,
          COUNT (au.codaula) AS qtd
        FROM
          diario.aulas au,
          diario.aulasservidor ase,
          DIARIO.DISCIPLINAS D,
          Diario.turmasaula ta,
          Diario.turmas tm,
          diario.componentespadrao cp,
          diario.clientelas c,
          diario.tiposensino te,
          diario.turnos tu
        WHERE
          au.codaula = ase.codaula
          AND au.codcomponentepadrao = cp.codcomponentepadrao
          AND cp.codclientela = c.codclientela
          AND AU.CODDISCIPLINA = D.CODDISCIPLINA
          AND c.codtipoensino = te.codtipoensino --AND Tm.CODCOMPONENTEPADRAO=cp.CODCOMPONENTEPADRAO
          AND Tm.anoreferencia = :anoref
          AND au.codturno = tu.codturno
          and au.codaula = ta.codaula
          and tm.codturma = ta.codturma
          AND ase.datacancelamento IS NULL
          AND TM.DATACANCELAMENTO IS NULL
          AND au.anoreferencia = :anoref -- AND (D.DISCIPLINA LIKE '%MUSICA%' OR D.DISCIPLINA LIKE'%MÚSICA%')
          --  AND ase.tipoaula = 'E'
          -- AND TE.TIPOENSINO LIKE'%JOVENS%ADULTO%'
          --AND  UPPER(tipoensino) LIKE '%T%CN%CO%'
          --OR UPPER(tipoensino) LIKE '%QUALIF%'
        GROUP BY
          au.coddisciplina,
          D.DISCIPLINA,
          C.CODCLIENTELA,
          C.CLIENTELA,
          TE.TIPOENSINO,
          AU.CODORGAO,
          ase.tipoaula,
          ase.cadastro,
          tu.turno,
          tm.turma,
          ase.datainicioprogramacao,
          ase.dataterminoprogramacao
        UNION ALL
          /* Aulas - Substituindo */
        SELECT
          au.coddisciplina,
          D.DISCIPLINA,
          C.CODCLIENTELA,
          C.CLIENTELA,
          TE.TIPOENSINO,
          ase.tipoaula,
          AU.CODORGAO,
          ase.cadastrosubstituto CADASTRO,
          'VAGA TEMP' TIPOPROG,
          tu.turno,
          tm.turma,
          ase.datainicioperiodo,
          ase.dataterminoperiodo,
          COUNT (au.codaula) AS qtd
        FROM
          diario.aulas au,
          diario.substituicoesservidores ase,
          DIARIO.DISCIPLINAS D,
          Diario.turmasaula ta,
          diario.turmas tm,
          diario.componentespadrao cp,
          diario.clientelas c,
          diario.tiposensino te,
          diario.turnos tu
        WHERE
          au.codaula = ase.codaula
          AND au.codcomponentepadrao = cp.codcomponentepadrao
          AND AU.CODDISCIPLINA = D.CODDISCIPLINA
          AND cp.codclientela = c.codclientela
          AND c.codtipoensino = te.codtipoensino
          and au.codturno = tu.codturno
          and tm.codturma = ta.codturma
          and au.codaula = ta.codaula
          AND ase.datacancelamento IS NULL
          AND TM.DATACANCELAMENTO IS NULL
          AND au.anoreferencia = :anoref --AND Tm.CODCOMPONENTEPADRAO=cp.CODCOMPONENTEPADRAO
          AND Tm.anoreferencia = :anoref --AND (D.DISCIPLINA LIKE '%MUSICA%' OR D.DISCIPLINA LIKE'%MÚSICA%')
          --    AND ase.tipoaula = 'E'
          --  AND TE.TIPOENSINO LIKE'%JOVENS%ADULTO%'
          --AND  UPPER(tipoensino) LIKE '%T%CN%CO%'
          --OR UPPER(tipoensino) LIKE '%QUALIF%'
        GROUP BY
          au.coddisciplina,
          D.DISCIPLINA,
          C.CODCLIENTELA,
          C.CLIENTELA,
          TE.TIPOENSINO,
          AU.CODORGAO,
          ase.tipoaula,
          ase.cadastrosubstituto,
          tu.turno,
          Tm.turma,
          ase.datainicioperiodo,
          ase.dataterminoperiodo
      ) prog,
      diario.anosreferencia ar
    WHERE
      prog.codorgao = ar.codorgao
      AND ar.anoreferencia = :anoref
      AND PROG.DATAFIM BETWEEN ar.terminoanoletivo -10
      AND ar.terminoanoletivo + 10 -- WHERE TRUNC (SYSDATE) BETWEEN PROG.DATAINICIO AND NVL (PROG.DATAFIM, '01/01/2500')
    GROUP BY
      PROG.CODORGAO,
      PROG.CADASTRO,
      PROG.CLIENTELA,
      PROG.TIPOENSINO,
      PROG.TURNO,
      PROG.CODDISCIPLINA,
      prog.disciplina
  ) prog,
  diario.m_view_orgao_direc odp
WHERE
  serv.cadastro = prog.cadastro
  AND prog.codorgao = odp.codorgao
  AND odp.anoreferencia = :anoref
  and prog.cadastro in (
    11545824,
    11649789,
    11516186,
    11254732,
    11255419,
    11575608,
    11541576,
    11461534,
    11451353,
    11544972,
    11494857,
    11540387,
    11453614,
    11461556,
    11305069,
    11240025,
    11532862,
    11638991,
    11546141,
    11476891,
    11495196,
    11532588,
    11368820,
    11322924,
    11530700,
    11553073,
    11540475,
    11530710,
    11473646,
    11499314,
    11466790,
    11464599,
    11368019,
    11437917,
    11554993,
    11540183,
    11554886,
    11493850,
    11530834,
    11553262,
    11530351,
    11544975,
    11476105,
    11540649,
    11413053,
    11554695,
    11554849,
    11530638,
    11494917,
    11311974,
    11257376,
    11258365,
    11241000,
    11259019,
    11259053,
    11312695,
    11258193,
    11258527,
    11258943,
    11246923,
    11240430,
    11241085,
    11240385,
    11311414,
    11541837,
    11349245,
    11259717,
    11240461,
    11530690,
    11459090,
    11377904,
    11309873,
    11241077,
    11253377,
    11335525,
    11539269,
    11553517,
    11522606,
    11395622,
    11539979,
    11378379,
    11551992,
    11537357,
    11475181,
    11311036,
    11239505,
    11530975,
    11257575,
    11436181,
    11306461,
    11530721,
    11461132,
    11334803,
    11238482,
    11453431,
    11384270,
    11471931,
    11256463,
    11256263,
    11256457,
    11356139,
    11347176,
    11584617,
    11239163,
    11452661,
    11472083,
    11361157,
    11243915,
    11635538,
    11538739,
    11451816,
    11555109,
    11239719,
    11544793,
    11542880,
    11540187,
    11534712,
    11460748,
    11555141,
    11540385,
    11472552,
    11379363,
    11353145,
    92007390,
    92007390,
    92007390,
    11412378,
    11454405,
    11357364,
    11361395,
    11353729,
    11339557,
    11312162,
    11339763,
    11256994,
    11238863,
    11245007,
    11257962,
    11238867,
    11532081,
    11357353,
    11357341,
    11638989,
    11554842,
    11637059,
    11653317,
    11510349,
    11545918,
    11450328,
    11554841,
    11344620,
    11304681,
    11477954,
    11257785,
    11459980,
    11554740,
    11397675,
    11329400,
    11420244,
    11460450,
    11415613,
    11554344,
    11531558,
    11533552,
    11633263,
    11575487,
    11259558,
    11453892,
    11304883,
    11254286,
    11254273,
    11552957,
    11554751,
    11540633,
    11453117,
    11510058,
    11530336,
    11367585,
    11305059,
    11255820,
    11377823,
    11240448,
    11341982,
    11304596,
    11366371,
    11628666,
    11531972,
    11540371,
    11450474,
    11509320,
    11455907,
    11458614,
    11494909,
    11494914,
    11530148,
    11368011,
    11377883,
    11356901,
    11348142,
    11304714,
    11348635,
    11332370,
    11258895,
    11274557,
    11259769,
    11367208,
    11371591,
    11243106,
    11304308,
    11345172,
    11381815,
    11335547,
    11254360,
    11281661,
    11343630,
    11419592,
    11243548,
    11555104,
    11532318,
    11538173,
    11555961,
    11540276,
    11532409,
    11532191,
    11540269,
    11453294,
    11537730,
    11460786,
    11348827,
    11273016,
    11532300,
    11335411,
    11419238,
    11555024,
    11388522,
    11426359,
    11331378,
    11317570,
    11304773,
    11274936,
    11240340,
    11303160,
    11331451,
    11304961,
    11236359,
    11305909,
    11254551,
    11414462,
    11308519,
    11237653,
    11305096,
    11236381,
    11282283,
    11520643,
    11531113,
    11456380,
    11471608,
    11530631,
    11449631,
    11510226,
    11272347,
    92008355,
    11532022,
    11350789,
    11349408,
    11272337,
    11246748,
    11239519,
    92013415,
    11304494,
    11254954,
    11370108,
    11349439,
    11254477,
    11236581,
    11531734,
    11531741,
    11531890,
    11459187,
    11532262,
    11257138,
    11272983,
    11259416,
    11433424,
    11376791,
    11253997,
    11360898,
    11536276,
    11553508,
    11257467,
    11254086,
    11552850,
    11281660,
    11274989,
    11276009,
    11273536,
    11283397,
    11259066,
    11281657,
    11550701,
    11540554,
    11529617,
    11551005,
    11555186,
    11529322,
    11551382,
    11540557,
    11495339,
    11552385,
    11540558,
    11529707,
    11540638,
    11538340,
    11452864,
    11555362,
    11529710,
    11540443,
    11521536,
    11529673,
    11529336,
    11445329,
    11637061,
    11641312,
    11557091,
    11531365,
    11346474,
    11645613,
    11509365,
    11411217,
    11383711,
    11445156,
    11552686,
    11531297,
    11459183,
    11445410,
    11418259,
    11419129,
    11392128,
    11346486,
    11529319,
    11550599,
    11521436,
    11348963,
    11545823,
    11375415,
    11541369,
    11546206,
    11529808,
    11384194,
    11376471,
    11383579,
    11359888,
    11309998,
    11304901,
    11305124,
    11434209,
    11341904,
    11554990,
    11449940,
    11392798,
    11342472,
    11305093,
    11369287,
    11384623,
    11371839,
    11307801,
    11304970,
    11275410,
    11357638,
    11254076,
    11451236,
    11413896,
    11395580,
    11342054,
    11348913,
    11305887,
    11274955,
    11252248,
    11240808,
    11311963,
    11368888,
    11338861,
    11310970,
    11521089,
    11494210,
    11335483,
    11304367,
    11304649,
    11274320,
    11258815,
    11245307,
    11245261,
    11246730,
    11248005,
    11242249,
    11237346,
    11316941,
    11444963,
    11314545,
    11332688,
    11315921,
    11304758,
    11445187,
    11365165,
    11394659,
    11376474,
    11365120,
    11368829,
    11341983,
    11316362,
    11376460,
    11344573,
    11317413,
    11303368,
    11365078,
    11342301,
    11342490,
    11248019,
    11411199,
    11383699,
    11352054,
    11347457,
    11332693,
    11410442,
    11257171,
    11250239,
    11351326,
    11342739,
    11304950,
    11242706,
    11361513,
    11335606,
    11310665,
    11305101,
    11250228,
    11419456,
    11349749,
    11341939,
    11343897,
    11335972,
    11310014,
    11304514,
    11304482,
    11540605,
    11273906,
    11252013,
    11391699,
    11392827,
    11335541,
    11346688,
    11281870,
    11247903,
    11241769,
    11335158,
    11303398,
    11310070,
    11303344,
    11342376,
    11359353,
    11275378,
    11254769,
    11394143,
    11318051,
    11303305,
    11365993,
    11248089,
    11463819,
    11336767,
    11255435,
    11259696,
    11344350,
    11341936,
    11319080,
    11229742,
    11355632,
    11259877,
    11374696,
    11352084,
    11445632,
    11242545,
    11329402,
    11552889,
    11541577,
    11257313
  ) --AND prog.codorgao in (serv.codorgao,serv.codorgaoc)
  --      AND serv.codsecul NOT IN (1179480) -- (1101511, 1179208, 1178066, 1176075)
  --ORDER BY serv.nte, serv.municipio, serv.codsecul, serv.orgao, serv.tiposervidor, serv.cadastro
ORDER BY
  serv.cadastro